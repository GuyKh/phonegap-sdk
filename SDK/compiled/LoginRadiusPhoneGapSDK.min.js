var win,params={},$LR={FB_native_permissions:{USER_BASIC_INFO:"public_profile",USER_ABOUT:"user_about_me",USER_BOOKS:"user_actions.books",USER_FITNESS:"user_actions.fitness",USER_MUSIC:"user_actions.music",USER_NEWS:"user_actions.news",USER_VIDEO:"user_actions.video",USER_ACTIVITIES:"user_activities",USER_BIRTHDAY:"user_birthday",USER_EDUCATION:"user_education_history",USER_EVENTS:"user_events",USER_FRIEND_USING_APP:"user_friends",USER_GAMES_ACTIVITY:"user_games_activity",USER_GROUPS:"user_groups",USER_HOMETOWN:"user_hometown",USER_INTERESTS:"user_interests",USER_LIKES:"user_likes",USER_LOCATION:"user_location",USER_PHOTOS:"user_photos",USER_RELATIONSHIPS:"user_relationships",USER_RELATIONSHIP_PREF:"user_relationship_details",USER_RELIGION_POLITICS:"user_religion_politics",USER_STATUS:"user_status",USER_TAGGED_PLACES:"user_tagged_places",USER_VIDEOS:"user_videos",USER_WEBSITE:"user_website",USER_WORK_HISTORY:"user_work_history",USER_EMAIL:"email",INSIGHTS:"read_insights",MAILBOX:"read_mailbox",STREAM:"read_stream",PAGE_MAILBOX:"read_page_mailboxes",FRIENDS:"read_friendlists",ADS_MANAGEMENT:"ads_management",ADS_READ:"ads_read",MANAGE_NOTIFICATIONS:"manage_notifications",PUBLISH_ACTIONS:"publish_actions",MANAGE_PAGES:"manage_pages",RSVP_EVENTS:"rsvp_events"},providers:[],URL:"https://{APP_NAME}.hub.loginradius.com/requesthandlor.aspx?apikey={API_KEY}&provider={PROVIDER}&callback=http://{APP_NAME}.hub.loginradius.com/is_access_token=true&scope=lr_basic",options:{permissions:["public_profile"]},APIDomain:"https://api.loginradius.com",HostedDomain:"https://cdn.loginradius.com/hub/prod/Theme/mobile/index.html",accessTokenPass:{FACEBOOK:"/api/v2/access_token/facebook?key={API_KEY}&fb_access_token={ACCESS_TOKEN}",GOOGLE:"/api/v2/access_token/google?key={API_KEY}&google_access_token={ACCESS_TOKEN}"},onLogin:{},providerCallback:function(){},init:function(e){$LR.util.jsonpCall("https://api.loginradius.com/api/v2/app/jsinterface?apikey="+e.apikey,function(e){$LR.providers=e.Providers,$LR.providerCallback()}),e.permissions||(e.permissions=this.options.permissions),this.options=e},login:function(e){if(this.options["native"]&&"FACEBOOK"==e.toUpperCase())try{facebookConnectPlugin.login($LR.options.permissions,this.util.nativeCallbackFacebookSuccess,this.util.nativeCallbackFacebookFail)}catch(o){alert(o)}else if(this.options["native"]&&"GOOGLE"==e.toUpperCase())try{GoogleLogin.login(this.util.nativeCallbackGoogleSuccess,this.util.nativeCallbackGoogleFailure,[])}catch(o){alert(o)}else{var i=$LR.util.getProviderUrl(e);console.log(i),$LR.util.openWindow(i)}},logout:function(){if(this.options["native"])try{facebookConnectPlugin.logout(this.util.nativeLogoutFacebookSuccess,this.util.nativeLogoutFacebookFailure)}catch(e){alert(e)}else sessionStorage.removeItem("LRTokenKey")},util:{openWindow:function(e){return e?(win=window.open(e,"_blank","width=450,height=500,toolbar=no"),win.addEventListener("loadstart",function(e){}),void win.addEventListener("loadstop",function(e){if(e.url.indexOf("?token")>0){var o=e.url.indexOf("?token");token=e.url.substring(o+7,o+43),sessionStorage.setItem("LRTokenKey",token),win.close(),$LR.onLogin()}})):!1},openWindowUserRegistration:function(e,o){return e?(win=window.open(e,"_blank","location=yes"),win.addEventListener("loadstop",function(e){var o=function(o){var i=new RegExp("[\\?&]"+o+"=([^&#]*)"),a=i.exec(e.url);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))},i=o("redirect");if(""!=i){var a=o("action");if(""!=a)switch(a){case"registration":var s=o("email"),t=o("status");params.email=s,params.status=t,params.action=a;break;case"login":var n=o("lrtoken"),r=o("lraccountid");params.action=a,params.token=n,params.lrUid=r;break;case"forgotpassword":var t=o("status"),s=o("email");params.status=t,params.email=s,params.action=a;break;case"sociallogin":var n=o("lrtoken");params.token=n,params.action=a;break;default:alert("action not defined")}win.close()}}),void win.addEventListener("exit",function(e){o(params)})):!1},addJs:function(e,o){o=o||document;var i=o.getElementsByTagName("head")[0],a=o.createElement("script");return a.src=e,a.type="text/javascript",i.appendChild(a),a},jsonpCall:function(e,o){var i="Loginradius"+Math.floor(1e18*Math.random()+1);window[i]=function(e){o(e),window[i]=void 0;try{delete window[i]}catch(a){}document.getElementsByTagName("head")[0].removeChild(s)};var a=-1!=e.indexOf("?")?e+"&callback="+i:e+"?callback="+i,s=this.addJs(a)},searchProviders:function(e){for(var o=0;o<$LR.providers.length;o++)if($LR.providers[o].Name.toLowerCase()==e.toLowerCase())return $LR.providers[o];return null},getProviderUrl:function(e){if(e=this.searchProviders(e)){var o=e.Endpoint;return o+="&ismobile=1&is_access_token=1"}},nativeCallbackGoogleSuccess:function(e){var o=$LR.APIDomain+$LR.accessTokenPass.GOOGLE;o=o.replace("{API_KEY}",$LR.options.apikey).replace("{ACCESS_TOKEN}",e),$LR.util.jsonpCall(o,$LR.util.LoginRadiusNativeCallback)},nativeCallbackFacebookSuccess:function(e){var o=$LR.APIDomain+$LR.accessTokenPass.FACEBOOK;o=o.replace("{API_KEY}",$LR.options.apikey).replace("{ACCESS_TOKEN}",e.authResponse.accessToken),$LR.util.jsonpCall(o,$LR.util.LoginRadiusNativeCallback)},nativeCallbackFacebookFail:function(e){console.log(e)},LoginRadiusNativeCallback:function(e){sessionStorage.setItem("LRTokenKey",e.access_token),$LR.onLogin()},nativeLogoutFacebookSuccess:function(e){sessionStorage.removeItem("LRTokenKey")},nativeLogoutFacebookFailure:function(e){console.log("error")},lrRegister:function(){var e=$LR.options.callback,o=$LR.HostedDomain+"?apikey="+$LR.options.apikey+"&sitename="+$LR.options.siteName+"&action=registration";$LR.util.openWindowUserRegistration(o,e)},lrSocial:function(){var e=$LR.options.callback,o=$LR.HostedDomain+"?apikey="+$LR.options.apikey+"&sitename="+$LR.options.siteName+"&action=social";$LR.util.openWindowUserRegistration(o,e)},lrForgotPassword:function(){var e=$LR.options.callback,o=$LR.HostedDomain+"?apikey="+$LR.options.apikey+"&sitename="+$LR.options.siteName+"&action=forgotpassword";$LR.util.openWindowUserRegistration(o,e)},lrLogin:function(){var e=$LR.options.callback,o=$LR.HostedDomain+"?apikey="+$LR.options.apikey+"&sitename="+$LR.options.siteName+"&action=login";$LR.util.openWindowUserRegistration(o,e)}}};